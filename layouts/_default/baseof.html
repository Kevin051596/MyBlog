<!DOCTYPE html>
<style type="text/css">
    .view-bar{
        width: 0;
        height: 2px;
        background-color: #77B6FF;
        position: fixed;
        top:0;
        z-index: 10;
    }
</style>
<html lang="{{ .Site.LanguageCode }}">
{{ partial "head.html" . }}
{{ partial "nav.html" . }}
<!-- Page Header -->
{{ block "header" .}}
<header class="intro-header" style="background-image: url('{{ .Site.Params.header_image | relURL }}')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 ">
                <div class="site-heading">
                    <h1>{{ .Site.Title}} </h1>
                    <!--<hr class="small">-->
		    <span class="subheading">{{ .Site.Params.slogan }}</span>
                </div>
            </div>
        </div>
    </div>
</header>
{{ end }}

<div class="view-bar"></div>

{{ block "main" . }}
{{ end }}

<button aria-label="買杯咖啡" class="show-zs btn btn-bred">
	<img width="50" height="50" src="/element/coffee_cup_drink_icon.png"/>
</button>
{{ partial "reward.html" . }}
<button aria-label="回到頂部" class="btn btn-moveTop">
    <img width="50" height="50" src="/element/arrow_circle_up_icon.png"/>
</button>

{{ partial "footer.html" . }}
</body>
</html>

<script>
let lastScrollTop = 0
const isDev = true
$(window).scroll(function(){
    // 瀏覽進度條
    if(isDev){
        const px = $(window).height();
        var view = ($(window).scrollTop()) / ($(document).height() - $(window).height()) * 100 + 'vw'
        $(".view-bar").width(view)
    }

    // 回到頂部
    const px = 100;
    var st = window.pageYOffset || document.documentElement.scrollTop
    if (window.pageYOffset > px &&  st < lastScrollTop) {
        $(`[aria-label="回到頂部"], [aria-label="買杯咖啡"]`).addClass("btn-moveTop-animate")
    } else {
        $(`[aria-label="回到頂部"], [aria-label="買杯咖啡"]`).removeClass("btn-moveTop-animate")
    }
    lastScrollTop = st <= 0 ? 0 : st
})

$(".btn-moveTop").click(function(e){
    e.preventDefault();
    $("html,body").animate(
        {
        scrollTop: 0,
        },
        600
    )
})

const labels = {
    python: [190, 220, 254, 211.9, 97, 87.1],
    javascript: [255, 222, 130, 44.2, 100, 75.5],
    git: [255, 155, 113, 17.7, 100, 72.2],
    selenium: [24, 53, 36, 143.5, 37.4, 38.8],
    "front-end": [92, 60, 70, 342, 65.6, 76.1],
    "back-end": [129, 83, 85, 357.4, 21.7, 41.6],
    hugo: [238, 75, 106, 348.6, 82.7, 61.4]
}


const lightness_threshold = 0.453
const border_threshold = 0.96
$(`[class="tag"]`).each((index, item) => {
        const text = item.innerText.toLowerCase()
        const [label_r, label_g, label_b, label_h, label_s, label_l] = labels[text]
        const perceived_lightness = (label_r * 0.2126 + label_g * 0.7152 + label_b * 0.0722) / 255 
        const lightness_switch = Math.max(0, Math.min((1 / (lightness_threshold - perceived_lightness)), 1))
        const border_alpha = Math.max(0, Math.min((perceived_lightness - border_threshold) * 100, 1))
        item.style.color = `hsl(0deg, 0%, calc(${lightness_switch} * 100%))`
        item.style.background = `rgb(${label_r}, ${label_g}, ${label_b})`
        item.style["border-color"] = `hsla(${label_h}, calc(${label_s} * 1%), calc(${label_l} - 25) * 1%), ${border_alpha})`
        item.style["font-weight"] = 500
        item.style.border = "1px solid transparent"
        item.style["font-family"] = `-apple-system,BlinkMacSystemFont,"Segoe UI","Noto Sans"`
    // item.addEventListener("mouseout", () => {
    //     item.removeAttribute("style", "color", "background", "border")
    // })
})

</script>

